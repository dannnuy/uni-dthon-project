Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Loading QueryBasedDetector model...
Using device: cuda
YOLO detector loaded from: /data/danielsohn0827000/uni-dthon-project/best.pt
CLIP model loaded: openai/clip-vit-base-patch32
EasyOCR loaded.
Model loading complete.
Mapping test queries from /data/danielsohn0827000/unid/open/test/query...
Building query-image map:   0%|          | 0/7530 [00:00<?, ?it/s]Building query-image map:   1%|          | 80/7530 [00:00<00:09, 797.54it/s]Building query-image map:   2%|▏         | 160/7530 [00:00<00:09, 760.16it/s]Building query-image map:   3%|▎         | 238/7530 [00:00<00:09, 765.46it/s]Building query-image map:   4%|▍         | 315/7530 [00:00<00:09, 748.89it/s]Building query-image map:   5%|▌         | 390/7530 [00:00<00:09, 738.15it/s]Building query-image map:   6%|▌         | 468/7530 [00:00<00:09, 751.52it/s]Building query-image map:   7%|▋         | 544/7530 [00:00<00:09, 716.11it/s]Building query-image map:   8%|▊         | 616/7530 [00:00<00:09, 713.35it/s]Building query-image map:   9%|▉         | 688/7530 [00:00<00:09, 697.68it/s]Building query-image map:  10%|█         | 758/7530 [00:01<00:09, 689.78it/s]Building query-image map:  11%|█         | 831/7530 [00:01<00:09, 701.02it/s]Building query-image map:  12%|█▏        | 902/7530 [00:01<00:09, 701.57it/s]Building query-image map:  13%|█▎        | 973/7530 [00:01<00:09, 683.92it/s]Building query-image map:  14%|█▍        | 1042/7530 [00:01<00:09, 671.53it/s]Building query-image map:  15%|█▍        | 1110/7530 [00:01<00:09, 661.54it/s]Building query-image map:  16%|█▌        | 1177/7530 [00:01<00:09, 643.55it/s]Building query-image map:  17%|█▋        | 1243/7530 [00:01<00:09, 648.11it/s]Building query-image map:  17%|█▋        | 1308/7530 [00:01<00:09, 647.43it/s]Building query-image map:  18%|█▊        | 1373/7530 [00:01<00:09, 642.01it/s]Building query-image map:  19%|█▉        | 1438/7530 [00:02<00:09, 643.29it/s]Building query-image map:  20%|█▉        | 1503/7530 [00:02<00:09, 631.11it/s]Building query-image map:  21%|██        | 1567/7530 [00:02<00:09, 627.01it/s]Building query-image map:  22%|██▏       | 1631/7530 [00:02<00:09, 618.32it/s]Building query-image map:  22%|██▏       | 1693/7530 [00:02<00:09, 611.34it/s]Building query-image map:  23%|██▎       | 1756/7530 [00:02<00:09, 616.73it/s]Building query-image map:  24%|██▍       | 1818/7530 [00:02<00:09, 601.23it/s]Building query-image map:  25%|██▍       | 1879/7530 [00:02<00:09, 587.64it/s]Building query-image map:  26%|██▌       | 1938/7530 [00:02<00:09, 580.87it/s]Building query-image map:  27%|██▋       | 1998/7530 [00:03<00:09, 583.64it/s]Building query-image map:  27%|██▋       | 2060/7530 [00:03<00:09, 591.56it/s]Building query-image map:  28%|██▊       | 2122/7530 [00:03<00:09, 598.94it/s]Building query-image map:  29%|██▉       | 2182/7530 [00:03<00:09, 584.65it/s]Building query-image map:  30%|██▉       | 2243/7530 [00:03<00:08, 589.91it/s]Building query-image map:  31%|███       | 2303/7530 [00:03<00:09, 577.40it/s]Building query-image map:  31%|███▏      | 2361/7530 [00:03<00:09, 572.14it/s]Building query-image map:  32%|███▏      | 2419/7530 [00:03<00:09, 564.58it/s]Building query-image map:  33%|███▎      | 2476/7530 [00:03<00:08, 562.12it/s]Building query-image map:  34%|███▎      | 2533/7530 [00:03<00:09, 546.94it/s]Building query-image map:  34%|███▍      | 2588/7530 [00:04<00:09, 542.47it/s]Building query-image map:  35%|███▌      | 2643/7530 [00:04<00:09, 519.63it/s]Building query-image map:  36%|███▌      | 2696/7530 [00:04<00:09, 518.82it/s]Building query-image map:  37%|███▋      | 2749/7530 [00:04<00:09, 519.96it/s]Building query-image map:  37%|███▋      | 2802/7530 [00:04<00:09, 518.89it/s]Building query-image map:  38%|███▊      | 2854/7530 [00:04<00:09, 518.04it/s]Building query-image map:  39%|███▊      | 2907/7530 [00:04<00:08, 520.23it/s]Building query-image map:  39%|███▉      | 2960/7530 [00:04<00:08, 519.56it/s]Building query-image map:  40%|████      | 3012/7530 [00:04<00:08, 503.20it/s]Building query-image map:  41%|████      | 3063/7530 [00:05<00:08, 503.05it/s]Building query-image map:  41%|████▏     | 3114/7530 [00:05<00:08, 502.70it/s]Building query-image map:  42%|████▏     | 3165/7530 [00:05<00:08, 492.88it/s]Building query-image map:  43%|████▎     | 3217/7530 [00:05<00:08, 498.20it/s]Building query-image map:  43%|████▎     | 3267/7530 [00:05<00:08, 487.26it/s]Building query-image map:  44%|████▍     | 3317/7530 [00:05<00:08, 490.01it/s]Building query-image map:  45%|████▍     | 3367/7530 [00:05<00:08, 485.77it/s]Building query-image map:  45%|████▌     | 3416/7530 [00:05<00:08, 479.93it/s]Building query-image map:  46%|████▌     | 3468/7530 [00:05<00:08, 491.22it/s]Building query-image map:  47%|████▋     | 3518/7530 [00:05<00:08, 491.77it/s]Building query-image map:  47%|████▋     | 3570/7530 [00:06<00:07, 499.95it/s]Building query-image map:  48%|████▊     | 3621/7530 [00:06<00:07, 498.25it/s]Building query-image map:  49%|████▉     | 3671/7530 [00:06<00:07, 487.88it/s]Building query-image map:  49%|████▉     | 3720/7530 [00:06<00:07, 478.32it/s]Building query-image map:  50%|█████     | 3769/7530 [00:06<00:07, 478.55it/s]Building query-image map:  51%|█████     | 3817/7530 [00:06<00:07, 478.05it/s]Building query-image map:  51%|█████▏    | 3866/7530 [00:06<00:07, 479.01it/s]Building query-image map:  52%|█████▏    | 3915/7530 [00:06<00:07, 481.53it/s]Building query-image map:  53%|█████▎    | 3964/7530 [00:06<00:07, 480.61it/s]Building query-image map:  53%|█████▎    | 4013/7530 [00:07<00:08, 391.06it/s]Building query-image map:  54%|█████▍    | 4059/7530 [00:07<00:08, 408.48it/s]Building query-image map:  54%|█████▍    | 4103/7530 [00:07<00:08, 415.44it/s]Building query-image map:  55%|█████▌    | 4147/7530 [00:07<00:08, 412.92it/s]Building query-image map:  56%|█████▌    | 4192/7530 [00:07<00:07, 421.03it/s]Building query-image map:  56%|█████▌    | 4235/7530 [00:07<00:07, 423.27it/s]Building query-image map:  57%|█████▋    | 4278/7530 [00:07<00:07, 424.78it/s]Building query-image map:  57%|█████▋    | 4321/7530 [00:07<00:07, 424.90it/s]Building query-image map:  58%|█████▊    | 4365/7530 [00:07<00:07, 427.06it/s]Building query-image map:  59%|█████▊    | 4410/7530 [00:07<00:07, 430.07it/s]Building query-image map:  59%|█████▉    | 4454/7530 [00:08<00:07, 427.27it/s]Building query-image map:  60%|█████▉    | 4497/7530 [00:08<00:07, 423.45it/s]Building query-image map:  60%|██████    | 4540/7530 [00:08<00:07, 416.30it/s]Building query-image map:  61%|██████    | 4582/7530 [00:08<00:07, 407.71it/s]Building query-image map:  61%|██████▏   | 4623/7530 [00:08<00:07, 402.74it/s]Building query-image map:  62%|██████▏   | 4664/7530 [00:08<00:07, 398.99it/s]Building query-image map:  62%|██████▏   | 4704/7530 [00:08<00:07, 392.69it/s]Building query-image map:  63%|██████▎   | 4744/7530 [00:08<00:07, 385.96it/s]Building query-image map:  64%|██████▎   | 4784/7530 [00:08<00:07, 388.84it/s]Building query-image map:  64%|██████▍   | 4823/7530 [00:09<00:07, 384.25it/s]Building query-image map:  65%|██████▍   | 4862/7530 [00:09<00:06, 381.78it/s]Building query-image map:  65%|██████▌   | 4901/7530 [00:09<00:06, 379.70it/s]Building query-image map:  66%|██████▌   | 4941/7530 [00:09<00:06, 383.86it/s]Building query-image map:  66%|██████▌   | 4980/7530 [00:09<00:06, 379.93it/s]Building query-image map:  67%|██████▋   | 5020/7530 [00:09<00:06, 383.87it/s]Building query-image map:  67%|██████▋   | 5059/7530 [00:09<00:06, 380.37it/s]Building query-image map:  68%|██████▊   | 5099/7530 [00:09<00:06, 385.89it/s]Building query-image map:  68%|██████▊   | 5138/7530 [00:09<00:06, 380.80it/s]Building query-image map:  69%|██████▉   | 5177/7530 [00:09<00:06, 369.68it/s]Building query-image map:  69%|██████▉   | 5217/7530 [00:10<00:06, 378.11it/s]Building query-image map:  70%|██████▉   | 5255/7530 [00:10<00:06, 376.12it/s]Building query-image map:  70%|███████   | 5293/7530 [00:10<00:06, 372.62it/s]Building query-image map:  71%|███████   | 5331/7530 [00:10<00:05, 372.31it/s]Building query-image map:  71%|███████▏  | 5369/7530 [00:10<00:05, 367.48it/s]Building query-image map:  72%|███████▏  | 5409/7530 [00:10<00:05, 373.26it/s]Building query-image map:  72%|███████▏  | 5448/7530 [00:10<00:05, 375.45it/s]Building query-image map:  73%|███████▎  | 5486/7530 [00:10<00:05, 367.74it/s]Building query-image map:  73%|███████▎  | 5527/7530 [00:10<00:05, 378.33it/s]Building query-image map:  74%|███████▍  | 5565/7530 [00:11<00:05, 375.31it/s]Building query-image map:  74%|███████▍  | 5603/7530 [00:11<00:05, 374.06it/s]Building query-image map:  75%|███████▍  | 5641/7530 [00:11<00:05, 374.93it/s]Building query-image map:  75%|███████▌  | 5679/7530 [00:11<00:04, 372.38it/s]Building query-image map:  76%|███████▌  | 5717/7530 [00:11<00:04, 369.43it/s]Building query-image map:  76%|███████▋  | 5754/7530 [00:11<00:04, 365.94it/s]Building query-image map:  77%|███████▋  | 5791/7530 [00:11<00:04, 364.58it/s]Building query-image map:  77%|███████▋  | 5829/7530 [00:11<00:04, 368.14it/s]Building query-image map:  78%|███████▊  | 5866/7530 [00:11<00:04, 362.43it/s]Building query-image map:  78%|███████▊  | 5903/7530 [00:11<00:04, 354.16it/s]Building query-image map:  79%|███████▉  | 5939/7530 [00:12<00:04, 354.24it/s]Building query-image map:  79%|███████▉  | 5977/7530 [00:12<00:04, 359.72it/s]Building query-image map:  80%|███████▉  | 6014/7530 [00:12<00:04, 362.46it/s]Building query-image map:  80%|████████  | 6051/7530 [00:12<00:04, 355.88it/s]Building query-image map:  81%|████████  | 6087/7530 [00:12<00:04, 354.88it/s]Building query-image map:  81%|████████▏ | 6124/7530 [00:12<00:03, 356.28it/s]Building query-image map:  82%|████████▏ | 6160/7530 [00:12<00:03, 354.94it/s]Building query-image map:  82%|████████▏ | 6197/7530 [00:12<00:03, 357.27it/s]Building query-image map:  83%|████████▎ | 6234/7530 [00:12<00:03, 358.97it/s]Building query-image map:  83%|████████▎ | 6270/7530 [00:12<00:03, 354.59it/s]Building query-image map:  84%|████████▎ | 6306/7530 [00:13<00:03, 352.72it/s]Building query-image map:  84%|████████▍ | 6342/7530 [00:13<00:03, 350.11it/s]Building query-image map:  85%|████████▍ | 6378/7530 [00:13<00:03, 350.13it/s]Building query-image map:  85%|████████▌ | 6414/7530 [00:13<00:03, 340.84it/s]Building query-image map:  86%|████████▌ | 6450/7530 [00:13<00:03, 344.41it/s]Building query-image map:  86%|████████▌ | 6485/7530 [00:13<00:03, 343.94it/s]Building query-image map:  87%|████████▋ | 6520/7530 [00:13<00:02, 341.99it/s]Building query-image map:  87%|████████▋ | 6555/7530 [00:13<00:02, 342.79it/s]Building query-image map:  88%|████████▊ | 6591/7530 [00:13<00:02, 346.58it/s]Building query-image map:  88%|████████▊ | 6626/7530 [00:14<00:02, 338.28it/s]Building query-image map:  88%|████████▊ | 6660/7530 [00:14<00:02, 332.45it/s]Building query-image map:  89%|████████▉ | 6694/7530 [00:14<00:02, 330.91it/s]Building query-image map:  89%|████████▉ | 6730/7530 [00:14<00:02, 338.31it/s]Building query-image map:  90%|████████▉ | 6766/7530 [00:14<00:02, 341.92it/s]Building query-image map:  90%|█████████ | 6801/7530 [00:14<00:02, 336.97it/s]Building query-image map:  91%|█████████ | 6836/7530 [00:14<00:02, 340.58it/s]Building query-image map:  91%|█████████ | 6871/7530 [00:14<00:01, 338.12it/s]Building query-image map:  92%|█████████▏| 6905/7530 [00:14<00:01, 334.08it/s]Building query-image map:  92%|█████████▏| 6939/7530 [00:14<00:01, 335.20it/s]Building query-image map:  93%|█████████▎| 6973/7530 [00:15<00:01, 335.00it/s]Building query-image map:  93%|█████████▎| 7007/7530 [00:15<00:01, 333.48it/s]Building query-image map:  94%|█████████▎| 7041/7530 [00:15<00:01, 326.57it/s]Building query-image map:  94%|█████████▍| 7075/7530 [00:15<00:01, 330.27it/s]Building query-image map:  94%|█████████▍| 7109/7530 [00:15<00:01, 331.72it/s]Building query-image map:  95%|█████████▍| 7143/7530 [00:15<00:01, 326.81it/s]Building query-image map:  95%|█████████▌| 7176/7530 [00:15<00:01, 325.97it/s]Building query-image map:  96%|█████████▌| 7209/7530 [00:15<00:00, 326.87it/s]Building query-image map:  96%|█████████▌| 7242/7530 [00:15<00:00, 326.79it/s]Building query-image map:  97%|█████████▋| 7275/7530 [00:15<00:00, 326.65it/s]Building query-image map:  97%|█████████▋| 7309/7530 [00:16<00:00, 328.47it/s]Building query-image map:  98%|█████████▊| 7342/7530 [00:16<00:00, 324.77it/s]Building query-image map:  98%|█████████▊| 7377/7530 [00:16<00:00, 328.71it/s]Building query-image map:  98%|█████████▊| 7410/7530 [00:16<00:00, 328.42it/s]Building query-image map:  99%|█████████▉| 7443/7530 [00:16<00:00, 323.16it/s]Building query-image map:  99%|█████████▉| 7476/7530 [00:16<00:00, 312.86it/s]Building query-image map: 100%|█████████▉| 7508/7530 [00:16<00:00, 314.22it/s]Building query-image map: 100%|██████████| 7530/7530 [00:16<00:00, 448.78it/s]
Mapped 5755 total queries to images.
Running inference on 5729 queries...
  0%|          | 0/5729 [00:00<?, ?it/s]  0%|          | 1/5729 [00:01<2:15:26,  1.42s/it]  0%|          | 2/5729 [00:01<1:25:28,  1.12it/s]  0%|          | 3/5729 [00:02<1:13:34,  1.30it/s]  0%|          | 4/5729 [00:03<1:01:40,  1.55it/s]  0%|          | 5/5729 [00:03<56:16,  1.70it/s]    0%|          | 6/5729 [00:03<48:24,  1.97it/s]  0%|          | 7/5729 [00:04<51:46,  1.84it/s]  0%|          | 8/5729 [00:04<47:07,  2.02it/s]  0%|          | 9/5729 [00:05<47:47,  1.99it/s]  0%|          | 10/5729 [00:05<47:50,  1.99it/s]  0%|          | 11/5729 [00:06<48:10,  1.98it/s]  0%|          | 12/5729 [00:06<43:56,  2.17it/s]  0%|          | 13/5729 [00:07<43:38,  2.18it/s]  0%|          | 14/5729 [00:07<43:32,  2.19it/s]  0%|          | 15/5729 [00:08<42:58,  2.22it/s]  0%|          | 16/5729 [00:08<40:08,  2.37it/s]  0%|          | 17/5729 [00:08<40:58,  2.32it/s]  0%|          | 18/5729 [00:09<44:52,  2.12it/s]  0%|          | 19/5729 [00:09<42:31,  2.24it/s]  0%|          | 20/5729 [00:10<43:28,  2.19it/s]  0%|          | 21/5729 [00:10<40:42,  2.34it/s]